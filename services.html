<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>All Services | GreenGlo Cleaners</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Montserrat:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <style>
        /* ===== CSS Reset & Variables ===== */
        :root {
            --primary-green: #10B981;
            --secondary-green: #34D399;
            --dark-green: #065F46;
            --light-green: #D1FAE5;
            --accent-green: #059669;
            --emerald: #10B981;
            --teal: #0D9488;
            --mint: #A7F3D0;
            --white: #FFFFFF;
            --off-white: #F9FAFB;
            --light-gray: #F3F4F6;
            --medium-gray: #9CA3AF;
            --dark-gray: #4B5563;
            --black: #111827;
            --gold: #FBBF24;
            --ruby: #DC2626;
            --sapphire: #2563EB;
            --amethyst: #7C3AED;
            --shadow: 0 20px 40px rgba(16, 185, 129, 0.12);
            --shadow-lg: 0 25px 50px rgba(16, 185, 129, 0.15);
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --border-radius: 16px;
            --border-radius-lg: 24px;
            --gradient-primary: linear-gradient(135deg, var(--primary-green), var(--teal));
            --gradient-dark: linear-gradient(135deg, var(--dark-green), var(--teal));
            --gradient-gold: linear-gradient(135deg, #FBBF24, #F59E0B);
            --gradient-silver: linear-gradient(135deg, #9CA3AF, #6B7280);
            --gradient-bronze: linear-gradient(135deg, #92400E, #B45309);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            scroll-padding-top: 80px;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            line-height: 1.7;
            color: var(--dark-gray);
            background-color: var(--off-white);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            line-height: 1.2;
            color: var(--dark-green);
            letter-spacing: -0.5px;
        }

        .container {
            width: 100%;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 1rem 2.5rem;
            background: var(--gradient-primary);
            color: var(--white);
            border: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            position: relative;
            overflow: hidden;
            z-index: 1;
            box-shadow: var(--shadow);
            gap: 0.75rem;
            min-height: 56px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-dark);
            opacity: 0;
            transition: var(--transition);
            z-index: -1;
        }

        .btn:hover::before {
            opacity: 1;
        }

        .btn:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .btn:active {
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-green);
            color: var(--primary-green);
        }

        .btn-outline:hover {
            background: var(--primary-green);
            color: var(--white);
        }

        .btn-large {
            padding: 1.25rem 3rem;
            font-size: 1.125rem;
            min-height: 64px;
        }

        /* ===== Navigation Bar ===== */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            z-index: 1000;
            border-bottom: 1px solid rgba(16, 185, 129, 0.1);
            transition: var(--transition);
        }

        .navbar.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.1);
            padding: 0.5rem 0;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 1.5rem;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            transition: var(--transition);
        }

        .nav-logo:hover {
            transform: translateY(-2px);
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.5rem;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-text h1 {
            font-size: 1.75rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
            line-height: 1;
        }

        .logo-text span {
            font-size: 0.75rem;
            color: var(--medium-gray);
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-top: 0.25rem;
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: 2rem;
            list-style: none;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            text-decoration: none;
            color: var(--dark-gray);
            font-weight: 600;
            font-size: 1rem;
            padding: 0.5rem 0;
            transition: var(--transition);
            position: relative;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--gradient-primary);
            transition: var(--transition);
        }

        .nav-link:hover {
            color: var(--primary-green);
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .nav-cta {
            margin-left: 1rem;
        }

        .nav-cta .btn {
            padding: 0.75rem 1.75rem;
            min-height: auto;
        }

        .mobile-menu-btn {
            display: none;
            width: 48px;
            height: 48px;
            background: var(--light-green);
            border-radius: 12px;
            border: none;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            color: var(--primary-green);
            font-size: 1.5rem;
            transition: var(--transition);
        }

        .mobile-menu-btn:hover {
            background: var(--mint);
            transform: rotate(90deg);
        }

        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .mobile-menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* ===== Modern Section Styles ===== */
        .section {
            padding: 6rem 0;
            position: relative;
        }

        .section-light {
            background: var(--white);
        }

        .section-gray {
            background: var(--off-white);
        }

        .section-title {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-title h2 {
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 1.5rem;
            position: relative;
            display: inline-block;
        }

        .section-title h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }

        .section-title p {
            font-size: 1.125rem;
            color: var(--medium-gray);
            max-width: 700px;
            margin: 0 auto;
        }

        /* ===== Services Hero Section ===== */
        .services-hero {
            min-height: 60vh;
            padding: 160px 0 80px;
            background: linear-gradient(135deg, rgba(209, 250, 229, 0.8) 0%, rgba(255, 255, 255, 0.9) 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            text-align: center;
        }

        .services-hero::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 60%;
            height: 100%;
            background: linear-gradient(135deg, var(--light-green) 0%, transparent 70%);
            z-index: 0;
        }

        .services-hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }

        .services-hero h1 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            margin-bottom: 1.5rem;
            line-height: 1.1;
            background: linear-gradient(to right, var(--dark-green), var(--teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .services-hero p {
            font-size: clamp(1.125rem, 3vw, 1.375rem);
            color: var(--dark-gray);
            margin-bottom: 3rem;
            line-height: 1.6;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* ===== Service Categories ===== */
        .category-filters {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 3rem;
        }

        .category-btn {
            padding: 0.875rem 1.75rem;
            background: var(--white);
            border: 2px solid var(--primary-green);
            border-radius: 50px;
            color: var(--primary-green);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            box-shadow: var(--shadow);
        }

        .category-btn:hover,
        .category-btn.active {
            background: var(--gradient-primary);
            color: var(--white);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* ===== Services Grid ===== */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2.5rem;
        }

        .service-card {
            background: var(--white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid rgba(16, 185, 129, 0.1);
            position: relative;
        }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-green);
        }

        /* Competitive pricing indicator */
        .service-card::after {
            content: 'BEST VALUE';
            position: absolute;
            top: 20px;
            right: -35px;
            background: var(--gradient-gold);
            color: var(--black);
            padding: 8px 40px;
            font-size: 11px;
            font-weight: 900;
            transform: rotate(45deg);
            z-index: 2;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
            letter-spacing: 1px;
        }

        .service-image {
            height: 220px;
            background-size: cover;
            background-position: center;
            position: relative;
            background-color: var(--light-green);
        }

        .service-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 50%, rgba(6, 95, 70, 0.8) 100%);
            display: flex;
            align-items: flex-end;
            padding: 2rem;
        }

        .service-overlay h3 {
            color: var(--white);
            font-size: 1.5rem;
            margin: 0;
        }

        .service-content {
            padding: 2rem;
        }

        /* Enhanced Price Display */
        .service-price-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .price-tag-main {
            font-size: 2.5rem;
            font-weight: 900;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            line-height: 1;
            padding: 0.5rem;
            position: relative;
            display: inline-block;
        }

        .price-tag-main::before {
            content: 'FROM';
            position: absolute;
            top: -10px;
            left: 0;
            right: 0;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--medium-gray);
            letter-spacing: 2px;
        }

        .price-tier-container {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .price-tier {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.75rem;
            border-radius: 12px;
            background: var(--light-green);
            min-width: 80px;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .price-tier:hover {
            transform: translateY(-3px);
            border-color: var(--primary-green);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.1);
        }

        .tier-badge {
            font-size: 0.75rem;
            font-weight: 700;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            margin-bottom: 0.5rem;
            color: white;
        }

        .tier-badge.gold {
            background: var(--gradient-gold);
        }

        .tier-badge.silver {
            background: var(--gradient-silver);
        }

        .tier-badge.bronze {
            background: var(--gradient-bronze);
        }

        .tier-bedrooms {
            font-size: 0.9rem;
            color: var(--dark-gray);
            font-weight: 600;
        }

        .tier-price {
            font-size: 1.25rem;
            font-weight: 800;
            color: var(--dark-green);
            margin-top: 0.25rem;
        }

        .service-duration-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--light-green);
            color: var(--dark-green);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.9rem;
            margin: 0 auto;
            border: 1px solid var(--secondary-green);
        }

        .service-description {
            color: var(--medium-gray);
            margin-bottom: 1.5rem;
            font-size: 1rem;
            line-height: 1.6;
        }

        .service-features {
            list-style: none;
            margin-bottom: 2rem;
        }

        .service-features li {
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(16, 185, 129, 0.1);
            display: flex;
            align-items: center;
            color: var(--dark-gray);
        }

        .service-features li:last-child {
            border-bottom: none;
        }

        .service-features li i {
            color: var(--secondary-green);
            margin-right: 0.75rem;
            font-size: 0.875rem;
            min-width: 20px;
        }

        .service-meta {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--light-green);
        }

        .service-cta {
            width: 100%;
        }

        .service-card .btn {
            width: 100%;
            justify-content: center;
            font-size: 1.125rem;
            padding: 1rem 2rem;
        }

        /* ===== Services CTA ===== */
        .services-cta {
            background: var(--gradient-dark);
            color: var(--white);
            text-align: center;
            padding: 6rem 0;
            border-radius: var(--border-radius-lg);
            margin: 4rem auto;
            max-width: 1200px;
        }

        .services-cta h2 {
            color: var(--white);
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 1.5rem;
        }

        .services-cta p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto 3rem;
        }

        /* ===== Booking Modal Styles ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }

        .booking-modal {
            background: white;
            border-radius: var(--border-radius-lg);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: var(--gradient-primary);
            color: white;
            padding: 25px 30px;
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 22px;
            font-weight: 600;
            margin: 0;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark-gray);
            font-size: 15px;
        }

        .form-control {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid var(--light-gray);
            border-radius: 12px;
            font-family: 'Montserrat', sans-serif;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Bedroom Selector */
        .bedroom-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .bedroom-option {
            border: 2px solid var(--light-gray);
            border-radius: 12px;
            padding: 15px 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: white;
        }

        .bedroom-option:hover {
            border-color: var(--primary-green);
            transform: translateY(-2px);
        }

        .bedroom-option.selected {
            background: var(--light-green);
            border-color: var(--primary-green);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .bedroom-icon {
            font-size: 24px;
            color: var(--dark-green);
            margin-bottom: 5px;
        }

        .bedroom-label {
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 3px;
        }

        .bedroom-price {
            font-size: 14px;
            font-weight: 700;
            color: var(--primary-green);
        }

        /* Price Display in Modal */
        .price-display {
            text-align: center;
            padding: 15px;
            background: var(--light-green);
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid var(--secondary-green);
        }

        .selected-price {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--dark-green);
            margin: 10px 0;
        }

        .price-breakdown {
            font-size: 14px;
            color: var(--medium-gray);
        }

        .time-slots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            margin-top: 10px;
        }

        .time-slot-option {
            border: 2px solid var(--light-gray);
            border-radius: 12px;
            padding: 18px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: white;
        }

        .time-slot-option:hover {
            border-color: var(--primary-green);
            transform: translateY(-2px);
        }

        .time-slot-option.selected {
            background: var(--light-green);
            border-color: var(--primary-green);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .booking-steps {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
        }

        .booking-summary {
            background: linear-gradient(135deg, var(--light-green), var(--mint));
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid var(--secondary-green);
        }

        /* ===== Premium Footer ===== */
        .footer {
            background: var(--dark-green);
            color: var(--white);
            padding: 6rem 0 2rem;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 4rem;
            margin-bottom: 4rem;
        }

        .footer-col h3 {
            color: var(--white);
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.75rem;
        }

        .footer-col h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--primary-green);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
            display: inline-block;
        }

        .footer-links a:hover {
            color: var(--white);
            transform: translateX(5px);
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .social-link {
            width: 44px;
            height: 44px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            text-decoration: none;
            transition: var(--transition);
        }

        .social-link:hover {
            background: var(--primary-green);
            transform: translateY(-3px);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.875rem;
        }

        .footer-bottom a {
            color: var(--primary-green);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-bottom a:hover {
            color: var(--secondary-green);
            text-decoration: underline;
        }

        /* ===== WhatsApp Button ===== */
        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9999;
        }

        .whatsapp-button {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 25px rgba(37, 211, 102, 0.4);
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
        }

        /* ===== Responsive Design ===== */
        @media (max-width: 768px) {
            .nav-menu {
                position: fixed;
                top: 0;
                right: -100%;
                width: 300px;
                height: 100vh;
                background: var(--white);
                flex-direction: column;
                padding: 100px 2rem 2rem;
                gap: 0;
                transition: var(--transition);
                box-shadow: -5px 0 30px rgba(0, 0, 0, 0.1);
                z-index: 1001;
                overflow-y: auto;
            }

            .nav-menu.active {
                right: 0;
            }

            .nav-item {
                width: 100%;
            }

            .nav-link {
                display: block;
                padding: 1.25rem 1rem;
                border-bottom: 1px solid rgba(16, 185, 129, 0.1);
                font-size: 1.1rem;
            }

            .nav-cta {
                margin: 2rem 0 0;
                width: 100%;
            }

            .nav-cta .btn {
                width: 100%;
                justify-content: center;
                padding: 1rem 2rem;
            }

            .mobile-menu-btn {
                display: flex;
                z-index: 1002;
                position: relative;
            }

            .mobile-menu-btn.active {
                background: var(--primary-green);
                color: var(--white);
            }

            .services-hero {
                padding: 140px 0 4rem;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }

            .section {
                padding: 4rem 0;
            }

            .category-filters {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 1rem;
                -webkit-overflow-scrolling: touch;
            }

            .category-btn {
                flex-shrink: 0;
            }

            .price-tag-main {
                font-size: 2rem;
            }

            .price-tier-container {
                flex-wrap: wrap;
            }

            .price-tier {
                min-width: 70px;
                padding: 0.5rem;
            }

            .tier-price {
                font-size: 1.1rem;
            }

            .service-card::after {
                font-size: 10px;
                padding: 6px 30px;
                right: -30px;
                top: 15px;
            }

            .mobile-menu-close {
                position: absolute;
                top: 1.5rem;
                right: 1.5rem;
                width: 44px;
                height: 44px;
                background: var(--light-green);
                border-radius: 12px;
                border: none;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                color: var(--primary-green);
                font-size: 1.25rem;
                transition: var(--transition);
                z-index: 1003;
            }

            .modal {
                width: 95%;
                padding: 15px;
            }

            .time-slots-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .bedroom-selector {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 1rem;
            }

            .nav-menu {
                width: 85%;
            }

            .service-card {
                margin-bottom: 1.5rem;
            }

            .service-content {
                padding: 1.5rem;
            }

            .time-slots-grid {
                grid-template-columns: 1fr;
            }

            .bedroom-selector {
                grid-template-columns: repeat(2, 1fr);
            }

            .selected-price {
                font-size: 2rem;
            }
        }
    </style>
</head>

<body>
    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>

    <!-- Premium Navigation Bar -->
    <nav class="navbar" id="navbar">
        <div class="container nav-container">
            <a href="index.html" class="nav-logo">
                <div class="logo-icon">
                    <img src="logo.png" alt="GreenGlo Cleaners Logo"
                        style="width: 100%; height: 100%; object-fit: contain; border-radius: 12px;">
                </div>
                <div class="logo-text">
                    <h1>GreenGlo</h1>
                    <span>Cleaners</span>
                </div>
            </a>

            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>

            <ul class="nav-menu" id="navMenu">
                <button class="mobile-menu-close" id="mobileCloseBtn">
                    <i class="fas fa-times"></i>
                </button>

                <li class="nav-item">
                    <a href="index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="services.html" class="nav-link">Services</a>
                </li>
                <li class="nav-item">
                    <a href="index.html#about" class="nav-link">About</a>
                </li>
                <li class="nav-item">
                    <a href="gallery.html" class="nav-link">Gallery</a>
                </li>
                <li class="nav-item">
                    <a href="index.html#testimonials" class="nav-link">Testimonials</a>
                </li>
                <li class="nav-item">
                    <a href="index.html#contact" class="nav-link">Contact</a>
                </li>
                <li class="nav-item nav-cta">
                    <a href="https://api.whatsapp.com/send?phone=447827784204&text=" class="btn">Get Quote</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal-overlay">
        <div class="booking-modal">
            <div class="modal-header">
                <h3>Book <span id="bookingServiceName">Service</span></h3>
                <button class="modal-close" id="closeBookingModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="bookingStep1">
                    <div class="form-group" id="bedroomSelectionGroup" style="display: none;">
                        <label>Select Number of Bedrooms</label>
                        <div id="bedroomSelector" class="bedroom-selector">
                            <!-- Bedroom options will be inserted here -->
                        </div>
                    </div>
                    
                    <div class="price-display" id="priceDisplay" style="display: none;">
                        <div class="selected-price" id="selectedPrice">¬£0</div>
                        <div class="price-breakdown" id="priceBreakdown">Select number of bedrooms to see price</div>
                    </div>
                    
                    <div class="form-group">
                        <label>Select Date</label>
                        <input type="date" id="bookingDate" class="form-control" min="" required>
                    </div>
                    <div class="form-group">
                        <label>Available Time Slots</label>
                        <div id="timeSlotsContainer" class="time-slots-grid">
                            <!-- Time slots will load here -->
                        </div>
                    </div>
                    <div class="booking-steps">
                        <button class="btn btn-outline" onclick="closeBookingModal()">Cancel</button>
                        <button class="btn btn-primary" onclick="nextBookingStep()">Next: Your Details</button>
                    </div>
                </div>

                <div id="bookingStep2" style="display: none;">
                    <div class="form-group">
                        <label>Your Full Name *</label>
                        <input type="text" id="customerName" class="form-control" required placeholder="John Smith">
                    </div>
                    <div class="form-group">
                        <label>Phone Number *</label>
                        <input type="tel" id="customerPhone" class="form-control" required placeholder="07123 456789">
                    </div>
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="customerEmail" class="form-control" placeholder="john@example.com">
                    </div>
                    <div class="form-group">
                        <label>Service Address *</label>
                        <textarea id="customerAddress" class="form-control" rows="3" required placeholder="Full address including postcode"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Special Instructions (Optional)</label>
                        <textarea id="bookingNotes" class="form-control" rows="3" placeholder="Any special requirements or notes..."></textarea>
                    </div>
                    
                    <div class="booking-summary" id="bookingSummary">
                        <h4 style="color: var(--dark-green); margin-bottom: 15px;">Booking Summary</h4>
                        <div id="summaryDetails"></div>
                    </div>
                    
                    <div class="booking-steps">
                        <button class="btn btn-outline" onclick="prevBookingStep()">Back</button>
                        <button class="btn btn-success" onclick="confirmBooking()">
                            <i class="fas fa-calendar-check"></i>
                            Confirm Booking
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Services Hero Section -->
    <section class="services-hero">
        <div class="container">
            <div class="services-hero-content">
                <h1>Our Complete Cleaning Services</h1>
                <p>Explore our comprehensive range of professional cleaning services, all using eco-friendly products
                    and performed by our vetted, background-checked professionals.</p>
                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <a href="#servicesGrid" class="btn btn-large">
                        <i class="fas fa-broom"></i>
                        View Services
                    </a>
                    <a href="index.html" class="btn btn-outline btn-large">
                        <i class="fas fa-home"></i>
                        Back to Home
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Service Categories -->
    <section class="section section-light">
        <div class="container">
            <div class="section-title">
                <h2>Browse by Category</h2>
                <p>Find the perfect cleaning service for your needs</p>
            </div>
            <div class="category-filters">
                <button class="category-btn active" data-category="all">All Services</button>
                <button class="category-btn" data-category="domestic">Domestic Cleaning</button>
                <button class="category-btn" data-category="office">Office Cleaning</button>
                <button class="category-btn" data-category="deep">Deep Cleaning</button>
                <button class="category-btn" data-category="special">Specialized Services</button>
            </div>
        </div>
    </section>

    <!-- Services Grid -->
    <section class="section section-gray">
        <div class="container">
            <div class="services-grid" id="servicesGrid">
                <!-- Service cards will be inserted here by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Services CTA -->
    <section class="section">
        <div class="container">
            <div class="services-cta">
                <h2>Need Help Choosing the Right Service?</h2>
                <p>Our cleaning experts are ready to help you select the perfect service for your needs. Get a
                    personalized quote or book a consultation today.</p>
                <div style="display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap;">
                    <a href="https://api.whatsapp.com/send?phone=447827784204&text=" class="btn btn-large"
                        style="background: var(--white); color: var(--primary-green);">
                        <i class="fab fa-whatsapp"></i>
                        Chat on WhatsApp
                    </a>
                    <a href="tel:+447827784204" class="btn btn-outline btn-large" style="color: var(--white);">
                        <i class="fas fa-phone"></i>
                        Call: 07827 784204
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>GreenGlo Cleaners</h3>
                    <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1.5rem;">
                        Professional eco-friendly cleaning services for homes and offices across London.
                    </p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                        <a href="https://instagram.com/greenglocleaningco" class="social-link"><i
                                class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>

                <div class="footer-col">
                    <h3>Our Services</h3>
                    <ul class="footer-links">
                        <li><a href="services.html">Domestic cleaning</a></li>
                        <li><a href="services.html">One-off cleaning</a></li>
                        <li><a href="services.html">End of tenancy cleaning</a></li>
                        <li><a href="services.html">Carpet cleaning</a></li>
                        <li><a href="services.html">Office cleaning</a></li>
                        <li><a href="services.html">View all services</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="services.html">Services</a></li>
                        <li><a href="gallery.html">Gallery</a></li>
                        <li><a href="index.html#faq">FAQ</a></li>
                        <li><a href="index.html#contact">Contact</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h3>Contact Us</h3>
                    <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1.5rem;">
                        <i class="fas fa-phone" style="margin-right: 0.5rem;"></i> 07827 784204
                    </p>
                    <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1.5rem;">
                        <i class="fas fa-envelope" style="margin-right: 0.5rem;"></i> greenglocleaning@gmail.com
                    </p>
                </div>
            </div>

            <div class="footer-bottom">
                <p>GreenGlo Cleaners London ¬© 2025. All rights reserved | <a href="#">Privacy Policy</a> | <a
                        href="#">Terms of Service</a></p>
            </div>
        </div>
    </footer>

    <!-- WhatsApp Button -->
    <div class="whatsapp-float">
        <a href="https://api.whatsapp.com/send?phone=447827784204&text=Hello%20GreenGlo%20Cleaners,%20I%20would%20like%20more%20information%20about%20your%20services"
           target="_blank" class="whatsapp-button">
            <i class="fab fa-whatsapp" style="color: white; font-size: 32px;"></i>
        </a>
    </div>

    <!-- JavaScript -->
    <script>
// ===== Mobile Navigation =====
const mobileMenuBtn = document.getElementById('mobileMenuBtn');
const mobileCloseBtn = document.getElementById('mobileCloseBtn');
const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
const navMenu = document.getElementById('navMenu');
const navbar = document.getElementById('navbar');
const navLinks = document.querySelectorAll('.nav-link');

// Function to open mobile menu
const openMobileMenu = () => {
    navMenu.classList.add('active');
    mobileMenuOverlay.classList.add('active');
    mobileMenuBtn.classList.add('active');
    mobileMenuBtn.innerHTML = '<i class="fas fa-times"></i>';
    document.body.style.overflow = 'hidden';
};

// Function to close mobile menu
const closeMobileMenu = () => {
    navMenu.classList.remove('active');
    mobileMenuOverlay.classList.remove('active');
    mobileMenuBtn.classList.remove('active');
    mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
    document.body.style.overflow = '';
};

// Toggle Mobile Menu
mobileMenuBtn.addEventListener('click', () => {
    if (navMenu.classList.contains('active')) {
        closeMobileMenu();
    } else {
        openMobileMenu();
    }
});

// Close Mobile Menu with Close Button
mobileCloseBtn.addEventListener('click', closeMobileMenu);

// Close Mobile Menu with Overlay Click
mobileMenuOverlay.addEventListener('click', closeMobileMenu);

// Close Mobile Menu on Link Click
navLinks.forEach(link => {
    link.addEventListener('click', closeMobileMenu);
});

// Close menu on Escape key press
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && navMenu.classList.contains('active')) {
        closeMobileMenu();
    }
});

// Navbar Scroll Effect
window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
        navbar.classList.add('scrolled');
    } else {
        navbar.classList.remove('scrolled');
    }
});

// ===== Booking System =====
const SUPABASE_URL = 'https://faxjeniohetefqwcsefi.supabase.co';
const SUPABASE_ANON_KEY = 'sb_publishable_7TZ_Y-HKZc_ibl59lqyAsQ_Qbv9A2o7';
const RESEND_API_KEY = 're_NiRLrvXk_4p6TfCmjQMXzVcGcnw99iDro';

let supabaseClient = null;
let currentBooking = {
    service: null,
    date: null,
    timeSlot: null,
    slotId: null,
    bedrooms: 1,
    calculatedPrice: 0,
    customer: {}
};

// Initialize Supabase
if (typeof supabase !== 'undefined') {
    supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    console.log('‚úÖ Supabase initialized');
} else {
    console.error('‚ùå Supabase SDK not loaded');
}

// Database Schema Check
async function checkDatabaseSchema() {
    console.log('üîç Checking database schema...');
    
    if (!supabaseClient) {
        console.error('‚ùå Supabase client not available');
        return false;
    }
    
    try {
        // Simple test query to check if table exists
        const { data, error } = await supabaseClient
            .from('bookings')
            .select('id')
            .limit(1);
        
        if (error) {
            console.error('‚ùå Bookings table error:', error);
            
            // Check if it's a column error
            if (error.message.includes('service_title') || error.code === 'PGRST204') {
                console.error('‚ùå Database schema mismatch. Please run the SQL setup in Supabase.');
                return false;
            }
            
            return false;
        }
        
        console.log('‚úÖ Bookings table is accessible');
        return true;
        
    } catch (err) {
        console.error('‚ùå Schema check error:', err);
        return false;
    }
}

// Show Connection Status
function showConnectionStatus(status, message) {
    const existingStatus = document.getElementById('dbStatus');
    if (existingStatus) {
        existingStatus.remove();
    }
    
    const statusDiv = document.createElement('div');
    statusDiv.id = 'dbStatus';
    statusDiv.style.cssText = `
        position: fixed;
        top: 80px;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 20px;
        border-radius: 8px;
        z-index: 10000;
        font-weight: bold;
        text-align: center;
        display: none;
    `;
    
    if (status === 'success') {
        statusDiv.style.background = '#d1fae5';
        statusDiv.style.color = '#065f46';
        statusDiv.style.border = '2px solid #10b981';
    } else {
        statusDiv.style.background = '#fef3c7';
        statusDiv.style.color = '#92400e';
        statusDiv.style.border = '2px solid #f59e0b';
    }
    
    statusDiv.textContent = message;
    document.body.appendChild(statusDiv);
    statusDiv.style.display = 'block';
    
    setTimeout(() => {
        statusDiv.style.display = 'none';
    }, 3000);
}

// Initialize Database Check
window.addEventListener('DOMContentLoaded', async function() {
    console.log('üîÑ Initializing booking system...');
    
    if (!supabaseClient) {
        showConnectionStatus('error', '‚ö†Ô∏è Booking system not available. Please contact us directly.');
        return;
    }
    
    const schemaOk = await checkDatabaseSchema();
    if (schemaOk) {
        showConnectionStatus('success', '‚úÖ Booking system ready!');
        console.log('‚úÖ Booking system initialized successfully');
    } else {
        showConnectionStatus('error', '‚ö†Ô∏è Booking system issues detected. Please call 07827 784204.');
        console.warn('‚ö†Ô∏è Database schema issues detected');
    }
});

// Enhanced logging for debugging
function logBookingState() {
    console.log('üìã Current Booking State:', {
        service: currentBooking.service,
        date: currentBooking.date,
        timeSlot: currentBooking.timeSlot,
        slotId: currentBooking.slotId,
        bedrooms: currentBooking.bedrooms,
        calculatedPrice: currentBooking.calculatedPrice
    });
}

// Email Confirmation Function
async function sendConfirmationEmail(customerEmail, bookingDetails) {
    console.log('üìß Sending confirmation email to:', customerEmail);
    
    // Only send if customer provided email
    if (!customerEmail || !customerEmail.includes('@')) {
        console.log('‚ö†Ô∏è No valid email provided, skipping email');
        return { success: false, reason: 'No valid email' };
    }
    
    const apiUrl = 'https://api.resend.com/emails';
    
    const emailData = {
        from: 'GreenGlo Cleaners <bookings@greenglocleaners.co.uk>',
        to: [customerEmail],
        reply_to: 'greenglocleaning@gmail.com',
        subject: `‚úÖ Booking Confirmed: ${bookingDetails.service} - ${bookingDetails.date}`,
        html: `
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="utf-8">
                <style>
                    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
                    .header { background: linear-gradient(135deg, #10B981, #0D9488); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
                    .content { background: #f9fafb; padding: 30px; border-radius: 0 0 10px 10px; border: 1px solid #e5e7eb; }
                    .booking-details { background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #10B981; }
                    .footer { text-align: center; margin-top: 30px; color: #6b7280; font-size: 14px; }
                    h1, h2, h3 { color: #065F46; }
                    .highlight { background: #D1FAE5; padding: 15px; border-radius: 8px; margin: 15px 0; }
                    .btn { display: inline-block; background: #10B981; color: white; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold; }
                    .price-badge { background: #FBBF24; color: #92400e; padding: 5px 10px; border-radius: 4px; font-weight: bold; font-size: 14px; }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1 style="color: white; margin: 0;">‚úÖ Booking Confirmed!</h1>
                    <p style="color: rgba(255,255,255,0.9); margin: 10px 0 0;">Thank you for choosing GreenGlo Cleaners</p>
                </div>
                
                <div class="content">
                    <h2>üìã Your Booking Summary</h2>
                    <div class="booking-details">
                        <p><strong>Service:</strong> ${bookingDetails.service}</p>
                        <p><strong>Date:</strong> ${new Date(bookingDetails.date).toLocaleDateString('en-GB', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
                        <p><strong>Time:</strong> ${bookingDetails.timeSlot}</p>
                        <p><strong>Duration:</strong> ${bookingDetails.duration}</p>
                        <p><strong>Bedrooms:</strong> ${bookingDetails.bedrooms}</p>
                        <p><strong>Price:</strong> <span class="price-badge">${bookingDetails.price}</span></p>
                    </div>
                    
                    <div class="highlight">
                        <h3>üë§ Your Details</h3>
                        <p><strong>Name:</strong> ${bookingDetails.customerName}</p>
                        <p><strong>Phone:</strong> ${bookingDetails.customerPhone}</p>
                        <p><strong>Address:</strong> ${bookingDetails.customerAddress}</p>
                    </div>
                    
                    <h3>üìû What Happens Next?</h3>
                    <ul>
                        <li><strong>24-Hour Confirmation Call:</strong> Our team will call you within 24 hours to confirm all details</li>
                        <li><strong>Preparation:</strong> Please ensure access to the property during the booked time</li>
                        <li><strong>Our Team:</strong> Vetted, background-checked cleaners with eco-friendly products</li>
                        <li><strong>Payment:</strong> Payment is due upon completion of service (Cash, Card, or Bank Transfer)</li>
                    </ul>
                    
                    <h3>üîÑ Need to Make Changes?</h3>
                    <p>Contact us at <a href="tel:07827784204" style="color: #10B981; font-weight: bold;">07827 784204</a> or reply to this email</p>
                    
                    <div style="text-align: center; margin: 30px 0;">
                        <a href="tel:07827784204" class="btn">üìû Call Us Now</a>
                    </div>
                    
                    <div class="footer">
                        <p><strong>GreenGlo Cleaners London</strong><br>
                        üìû 07827 784204 | ‚úâÔ∏è greenglocleaning@gmail.com</p>
                        <p style="font-size: 12px; color: #9CA3AF; margin-top: 20px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                            This is an automated confirmation email. Please do not reply directly to this email.<br>
                            Booking Reference: ${bookingDetails.bookingId || new Date().getTime()}
                        </p>
                    </div>
                </div>
            </body>
            </html>
        `,
        text: `
            ‚úÖ BOOKING CONFIRMED - GreenGlo Cleaners
            
            Your booking has been successfully confirmed!
            
            SERVICE DETAILS:
            =================
            Service: ${bookingDetails.service}
            Date: ${bookingDetails.date}
            Time: ${bookingDetails.timeSlot}
            Duration: ${bookingDetails.duration}
            Bedrooms: ${bookingDetails.bedrooms}
            Price: ${bookingDetails.price}
            
            CUSTOMER DETAILS:
            =================
            Name: ${bookingDetails.customerName}
            Phone: ${bookingDetails.customerPhone}
            Address: ${bookingDetails.customerAddress}
            
            NEXT STEPS:
            ===========
            1. We will call you within 24 hours to confirm all details
            2. Please ensure someone is available at the address
            3. Our cleaners will arrive with all necessary equipment
            4. Payment is due upon completion
            
            Need help? Call us at 07827 784204
            
            ---
            GreenGlo Cleaners London
            07827 784204 | greenglocleaning@gmail.com
            www.greenglocleaners.co.uk
        `
    };
    
    try {
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${RESEND_API_KEY}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(emailData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
            console.log('‚úÖ Email sent successfully:', data);
            return { success: true, data };
        } else {
            console.error('‚ùå Email sending failed:', data);
            return { success: false, error: data };
        }
    } catch (error) {
        console.error('‚ùå Email sending error:', error);
        return { success: false, error: error.message };
    }
}

// ===== Booking Modal Functions =====
function openBookingModal(serviceTitle, serviceId, serviceData) {
    console.log('üìÖ Opening booking modal for:', serviceTitle, 'Data:', serviceData);
    
    currentBooking.service = {
        title: serviceTitle,
        id: serviceId,
        data: serviceData
    };
    
    document.getElementById('bookingServiceName').textContent = serviceTitle;
    
    // Reset booking details
    currentBooking.bedrooms = 1;
    currentBooking.calculatedPrice = 0;
    
    // Show/hide bedroom selector based on service type
    const bedroomGroup = document.getElementById('bedroomSelectionGroup');
    const priceDisplay = document.getElementById('priceDisplay');
    
    if (serviceData.hasBedrooms) {
        bedroomGroup.style.display = 'block';
        priceDisplay.style.display = 'block';
        renderBedroomOptions(serviceData);
    } else {
        bedroomGroup.style.display = 'none';
        priceDisplay.style.display = 'block';
        updatePriceDisplay(serviceData.basePrice);
    }
    
    // Set min date to today
    const today = new Date().toISOString().split('T')[0];
    const dateInput = document.getElementById('bookingDate');
    dateInput.min = today;
    dateInput.value = today;
    currentBooking.date = today;
    
    // Load time slots
    loadTimeSlots(today);
    
    // Show modal
    document.getElementById('bookingModal').style.display = 'flex';
    document.getElementById('bookingStep1').style.display = 'block';
    document.getElementById('bookingStep2').style.display = 'none';
    
    // Reset form
    document.getElementById('customerName').value = '';
    document.getElementById('customerPhone').value = '';
    document.getElementById('customerEmail').value = '';
    document.getElementById('customerAddress').value = '';
    document.getElementById('bookingNotes').value = '';
    
    console.log('‚úÖ Booking modal opened');
}

function renderBedroomOptions(serviceData) {
    const container = document.getElementById('bedroomSelector');
    container.innerHTML = '';
    
    const bedroomOptions = [
        { value: 1, label: '1 Bed', icon: 'bed', price: serviceData.basePrice },
        { value: 2, label: '2 Bed', icon: 'bed', price: serviceData.basePrice + serviceData.perBedroomPrice },
        { value: 3, label: '3 Bed', icon: 'bed', price: serviceData.basePrice + (serviceData.perBedroomPrice * 2) },
        { value: 4, label: '4 Bed', icon: 'bed', price: serviceData.basePrice + (serviceData.perBedroomPrice * 3) },
        { value: 5, label: '5+ Bed', icon: 'bed', price: serviceData.basePrice + (serviceData.perBedroomPrice * 4) }
    ];
    
    bedroomOptions.forEach(option => {
        const optionElement = document.createElement('div');
        optionElement.className = 'bedroom-option';
        optionElement.dataset.bedrooms = option.value;
        optionElement.dataset.price = option.price;
        
        optionElement.innerHTML = `
            <div class="bedroom-icon">
                <i class="fas fa-${option.icon}"></i>
            </div>
            <div class="bedroom-label">${option.label}</div>
            <div class="bedroom-price">¬£${option.price}</div>
        `;
        
        optionElement.addEventListener('click', function() {
            // Deselect all
            document.querySelectorAll('.bedroom-option').forEach(o => {
                o.classList.remove('selected');
            });
            
            // Select this one
            this.classList.add('selected');
            
            // Update booking
            currentBooking.bedrooms = option.value;
            currentBooking.calculatedPrice = option.price;
            
            updatePriceDisplay(option.price);
            console.log('‚úÖ Selected bedrooms:', option.value, 'Price: ¬£' + option.price);
        });
        
        container.appendChild(optionElement);
    });
    
    // Select first option by default
    const firstOption = container.querySelector('.bedroom-option');
    if (firstOption) {
        firstOption.classList.add('selected');
        currentBooking.bedrooms = 1;
        currentBooking.calculatedPrice = bedroomOptions[0].price;
        updatePriceDisplay(bedroomOptions[0].price);
    }
}

function updatePriceDisplay(price) {
    document.getElementById('selectedPrice').textContent = `¬£${price}`;
    
    if (currentBooking.service.data.hasBedrooms) {
        const basePrice = currentBooking.service.data.basePrice;
        const perBedroom = currentBooking.service.data.perBedroomPrice;
        const breakdown = currentBooking.bedrooms > 1 
            ? `Base: ¬£${basePrice} + ¬£${perBedroom} √ó ${currentBooking.bedrooms - 1} bedroom(s)`
            : 'Standard 1 bedroom rate';
        
        document.getElementById('priceBreakdown').textContent = breakdown;
    } else {
        document.getElementById('priceBreakdown').textContent = 'Fixed price service';
    }
}

function closeBookingModal() {
    document.getElementById('bookingModal').style.display = 'none';
    currentBooking = {
        service: null,
        date: null,
        timeSlot: null,
        slotId: null,
        bedrooms: 1,
        calculatedPrice: 0,
        customer: {}
    };
    console.log('üìÖ Booking modal closed');
}

// Close modal when clicking outside
document.getElementById('bookingModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeBookingModal();
    }
});

// Close modal with ESC key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && document.getElementById('bookingModal').style.display === 'flex') {
        closeBookingModal();
    }
});

// Date change handler
document.getElementById('bookingDate').addEventListener('change', function() {
    currentBooking.date = this.value;
    loadTimeSlots(this.value);
});

// Load available time slots
async function loadTimeSlots(date) {
    const container = document.getElementById('timeSlotsContainer');
    container.innerHTML = '<div style="grid-column: span 2; text-align: center; padding: 40px; color: var(--medium-gray);"><i class="fas fa-spinner fa-spin fa-2x"></i><div style="margin-top: 10px;">Loading available time slots...</div></div>';
    
    if (!supabaseClient) {
        container.innerHTML = '<div style="grid-column: span 2; text-align: center; padding: 40px; color: var(--red);"><i class="fas fa-exclamation-triangle fa-2x"></i><div style="margin-top: 10px;">Error: Cannot connect to booking system</div></div>';
        return;
    }
    
    try {
        console.log('üïí Loading time slots for:', date);
        
        const { data: availability, error } = await supabaseClient
            .from('availability')
            .select('*')
            .eq('date', date)
            .eq('is_available', true)
            .order('time_slot');
        
        if (error) {
            console.error('‚ùå Error loading time slots:', error);
            throw error;
        }
        
        console.log(`‚úÖ Found ${availability?.length || 0} available slots`);
        
        container.innerHTML = '';
        
        if (!availability || availability.length === 0) {
            container.innerHTML = `
                <div style="grid-column: span 2; text-align: center; padding: 40px; color: var(--medium-gray);">
                    <i class="fas fa-calendar-times fa-2x"></i>
                    <div style="margin-top: 15px; font-size: 18px; margin-bottom: 10px;">No Available Slots</div>
                    <div>No time slots available for ${new Date(date).toLocaleDateString('en-GB', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                    <div style="margin-top: 15px; font-size: 14px; color: var(--primary-green);">
                        <i class="fas fa-phone"></i> Call us at 07827 784204 for alternative times
                    </div>
                </div>
            `;
            return;
        }
        
        // Clear any previously selected time slot
        currentBooking.timeSlot = null;
        currentBooking.slotId = null;
        
        availability.forEach(slot => {
            const slotElement = document.createElement('div');
            slotElement.className = 'time-slot-option';
            slotElement.dataset.slotId = slot.id;
            slotElement.dataset.timeSlot = slot.time_slot;
            
            const [start, end] = slot.time_slot.split('-');
            
            slotElement.innerHTML = `
                <div style="font-weight: 700; color: var(--dark-green); margin-bottom: 5px; font-size: 18px;">
                    ${formatTime(start)}
                </div>
                <div style="font-size: 13px; color: var(--medium-gray); margin-bottom: 5px;">
                    to ${formatTime(end)}
                </div>
                <div style="font-size: 11px; color: var(--primary-green);">
                    <i class="fas fa-check-circle"></i> Available
                </div>
            `;
            
            slotElement.addEventListener('click', function() {
                // Deselect all
                document.querySelectorAll('.time-slot-option').forEach(s => {
                    s.classList.remove('selected');
                });
                
                // Select this one
                this.classList.add('selected');
                
                // Update booking - ensure slot.id is converted to string
                currentBooking.timeSlot = slot.time_slot;
                currentBooking.slotId = String(slot.id);
                
                console.log('‚úÖ Selected time slot:', slot.time_slot, 'Slot ID:', slot.id);
            });
            
            container.appendChild(slotElement);
        });
        
    } catch (err) {
        console.error('‚ùå Error loading time slots:', err);
        container.innerHTML = `
            <div style="grid-column: span 2; text-align: center; padding: 40px; color: var(--red);">
                <i class="fas fa-exclamation-triangle fa-2x"></i>
                <div style="margin-top: 15px; font-size: 18px; margin-bottom: 10px;">Connection Error</div>
                <div>Unable to load time slots. Please try again.</div>
                <button onclick="loadTimeSlots('${date}')" class="btn btn-outline" style="margin-top: 20px; padding: 10px 20px;">
                    <i class="fas fa-redo"></i> Retry
                </button>
            </div>
        `;
    }
}

function formatTime(time) {
    const [hour, minute] = time.split(':');
    const hourNum = parseInt(hour);
    const suffix = hourNum >= 12 ? 'PM' : 'AM';
    const displayHour = hourNum > 12 ? hourNum - 12 : (hourNum === 0 ? 12 : hourNum);
    return `${displayHour}:${minute} ${suffix}`;
}

function nextBookingStep() {
    // Validate price calculation
    if (currentBooking.service.data.hasBedrooms && currentBooking.calculatedPrice <= 0) {
        alert('‚ö†Ô∏è Please select number of bedrooms');
        return;
    }
    
    if (!currentBooking.timeSlot) {
        alert('‚ö†Ô∏è Please select a time slot');
        return;
    }
    
    // Log for debugging
    logBookingState();
    
    if (!currentBooking.slotId) {
        alert('‚ö†Ô∏è Error: No slot ID selected. Please select a time slot again.');
        return;
    }
    
    // Ensure slotId is a string
    currentBooking.slotId = String(currentBooking.slotId);
    
    // Update summary
    updateBookingSummary();
    
    // Show step 2
    document.getElementById('bookingStep1').style.display = 'none';
    document.getElementById('bookingStep2').style.display = 'block';
    
    console.log('‚úÖ Moving to customer details step');
}

function prevBookingStep() {
    document.getElementById('bookingStep2').style.display = 'none';
    document.getElementById('bookingStep1').style.display = 'block';
    console.log('‚¨ÖÔ∏è Returning to time slot selection');
}

function updateBookingSummary() {
    const summary = document.getElementById('summaryDetails');
    const [start, end] = currentBooking.timeSlot.split('-');
    const bookingDate = new Date(currentBooking.date);
    
    // Convert slotId to string to avoid substring error
    const slotIdStr = String(currentBooking.slotId || '');
    
    let priceDisplay = currentBooking.calculatedPrice 
        ? `¬£${currentBooking.calculatedPrice}`
        : currentBooking.service.data.displayPrice;
    
    let bedroomInfo = '';
    if (currentBooking.service.data.hasBedrooms) {
        bedroomInfo = `
            <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid rgba(16, 185, 129, 0.2);">
                <span style="color: var(--dark-gray); font-weight: 600;">Bedrooms:</span>
                <span>${currentBooking.bedrooms} bedroom${currentBooking.bedrooms > 1 ? 's' : ''}</span>
            </div>
        `;
    }
    
    summary.innerHTML = `
        <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid rgba(16, 185, 129, 0.2);">
            <span style="color: var(--dark-gray); font-weight: 600;">Service:</span>
            <span style="font-weight: 700; color: var(--dark-green);">${currentBooking.service.title}</span>
        </div>
        ${bedroomInfo}
        <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid rgba(16, 185, 129, 0.2);">
            <span style="color: var(--dark-gray); font-weight: 600;">Price:</span>
            <span style="font-weight: 700; color: var(--primary-green); font-size: 1.25rem;">${priceDisplay}</span>
        </div>
        <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid rgba(16, 185, 129, 0.2);">
            <span style="color: var(--dark-gray); font-weight: 600;">Date:</span>
            <span>${bookingDate.toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}</span>
        </div>
        <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid rgba(16, 185, 129, 0.2);">
            <span style="color: var(--dark-gray); font-weight: 600;">Time:</span>
            <span style="font-weight: 600; color: var(--primary-green);">${formatTime(start)} - ${formatTime(end)}</span>
        </div>
    `;
}

// Main Booking Confirmation Function
async function confirmBooking() {
    console.log('üöÄ Starting booking confirmation process...');
    
    // Validate form
    const customerName = document.getElementById('customerName').value.trim();
    const customerPhone = document.getElementById('customerPhone').value.trim();
    const customerAddress = document.getElementById('customerAddress').value.trim();
    const customerEmail = document.getElementById('customerEmail').value.trim();
    
    if (!customerName || !customerPhone || !customerAddress) {
        alert('‚ùå Please fill in all required fields:\n\n‚Ä¢ Full Name\n‚Ä¢ Phone Number\n‚Ä¢ Service Address');
        return;
    }
    
    if (!currentBooking.timeSlot || !currentBooking.slotId) {
        alert('‚ùå Please select a time slot');
        return;
    }
    
    if (!supabaseClient) {
        alert('‚ùå Cannot connect to booking system.\n\nPlease call us directly at 07827 784204.');
        return;
    }
    
    // Disable the confirm button to prevent double-clicking
    const confirmBtn = document.querySelector('.btn-success');
    const originalText = confirmBtn.innerHTML;
    confirmBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing Booking...';
    confirmBtn.disabled = true;
    
    try {
        console.log('1Ô∏è‚É£ Checking slot availability...');
        
        // 1. Check if slot is still available
        const { data: slotCheck, error: checkError } = await supabaseClient
            .from('availability')
            .select('*')
            .eq('id', currentBooking.slotId)
            .eq('is_available', true)
            .single();
        
        if (checkError || !slotCheck) {
            alert('‚ùå This time slot is no longer available.\n\nPlease select another time slot.');
            loadTimeSlots(currentBooking.date);
            return;
        }
        
        console.log('‚úÖ Slot is available');
        console.log('2Ô∏è‚É£ Creating booking record...');
        
        // Find service duration
        const serviceData = currentBooking.service.data;
        const serviceDuration = serviceData.duration;
        
        // Generate booking reference
        const bookingRef = 'GG' + Date.now().toString().slice(-8);
        
        // Calculate final price
        const finalPrice = currentBooking.calculatedPrice || serviceData.basePrice;
        
        // 2. Prepare booking data
        const bookingData = {
            service_title: currentBooking.service.title,
            service_id: parseInt(currentBooking.service.id),
            customer_name: customerName,
            customer_phone: customerPhone,
            customer_email: customerEmail || null,
            customer_address: customerAddress,
            booking_date: currentBooking.date,
            time_slot: currentBooking.timeSlot,
            duration: serviceDuration,
            bedrooms: currentBooking.service.data.hasBedrooms ? currentBooking.bedrooms : null,
            price: `¬£${finalPrice}`,
            calculated_price: finalPrice,
            notes: document.getElementById('bookingNotes').value.trim() || null,
            status: 'confirmed',
            booking_reference: bookingRef,
            created_at: new Date().toISOString()
        };
        
        console.log('üìù Booking data prepared:', bookingData);
        
        // 3. Insert booking record
        const { data: booking, error: bookingError } = await supabaseClient
            .from('bookings')
            .insert([bookingData])
            .select()
            .single();

        if (bookingError) {
            console.error('‚ùå Booking insert error:', bookingError);
            
            // Try alternative insert method
            const { error: simpleInsertError } = await supabaseClient
                .from('bookings')
                .insert(bookingData);
            
            if (simpleInsertError) {
                // Try with simpler data structure
                const simpleData = {
                    service_title: currentBooking.service.title,
                    customer_name: customerName,
                    customer_phone: customerPhone,
                    customer_address: customerAddress,
                    booking_date: currentBooking.date,
                    time_slot: currentBooking.timeSlot,
                    price: `¬£${finalPrice}`,
                    status: 'confirmed',
                    booking_reference: bookingRef
                };
                
                const { error: minimalError } = await supabaseClient
                    .from('bookings')
                    .insert(simpleData);
                
                if (minimalError) {
                    throw new Error(`Database insert failed: ${minimalError.message}`);
                }
                console.log('‚úÖ Booking created (minimal data)');
            } else {
                console.log('‚úÖ Booking created (alternative method)');
            }
        } else {
            console.log('‚úÖ Booking created:', booking);
        }
        
        console.log('3Ô∏è‚É£ Updating availability...');
        
        // 4. Update availability to booked
        const { error: updateError } = await supabaseClient
            .from('availability')
            .update({ 
                is_available: false,
                updated_at: new Date().toISOString()
            })
            .eq('id', currentBooking.slotId);
        
        if (updateError) {
            console.error('‚ö†Ô∏è Availability update warning:', updateError);
            console.warn('Booking created but availability not updated');
        } else {
            console.log('‚úÖ Availability updated');
        }
        
        console.log('4Ô∏è‚É£ Sending email confirmation...');
        
        // 5. Prepare booking details for email
        const bookingDetails = {
            service: currentBooking.service.title,
            date: currentBooking.date,
            timeSlot: currentBooking.timeSlot,
            duration: serviceDuration,
            bedrooms: currentBooking.service.data.hasBedrooms ? currentBooking.bedrooms : 'N/A',
            price: `¬£${finalPrice}`,
            customerName: customerName,
            customerPhone: customerPhone,
            customerEmail: customerEmail,
            customerAddress: customerAddress,
            bookingId: bookingRef
        };
        
        // 6. Send confirmation email
        let emailSent = false;
        if (customerEmail && customerEmail.includes('@')) {
            try {
                const emailResult = await sendConfirmationEmail(customerEmail, bookingDetails);
                if (emailResult.success) {
                    emailSent = true;
                    console.log('‚úÖ Email sent successfully');
                } else {
                    console.warn('‚ö†Ô∏è Email sending failed:', emailResult.error);
                }
            } catch (emailError) {
                console.warn('‚ö†Ô∏è Email sending error:', emailError);
            }
        }
        
        console.log('5Ô∏è‚É£ Sending WhatsApp notification...');
        
        // 7. Send WhatsApp notification
        const whatsappMessage = encodeURIComponent(
            `üìÖ NEW BOOKING CONFIRMED - GreenGlo Cleaners\n\n` +
            `üõ†Ô∏è Service: ${currentBooking.service.title}\n` +
            `üí∞ Price: ¬£${finalPrice}\n` +
            `üõèÔ∏è Bedrooms: ${currentBooking.service.data.hasBedrooms ? currentBooking.bedrooms : 'N/A'}\n` +
            `üìÖ Date: ${currentBooking.date}\n` +
            `üïí Time: ${currentBooking.timeSlot}\n` +
            `üìû Customer: ${customerName}\n` +
            `‚òéÔ∏è Phone: ${customerPhone}\n` +
            `üìß Email: ${customerEmail || 'Not provided'}\n` +
            `üè† Address: ${customerAddress}\n` +
            `üìù Notes: ${document.getElementById('bookingNotes').value.trim() || 'None'}\n` +
            `üîó Booking Ref: ${bookingRef}\n` +
            `üìß Email Status: ${emailSent ? '‚úÖ Sent' : '‚ùå Not sent'}\n\n` +
            `üí∞ Revenue: ¬£${finalPrice}`
        );
        
        const whatsappUrl = `https://api.whatsapp.com/send?phone=447827784204&text=${whatsappMessage}`;
        window.open(whatsappUrl, '_blank');
        
        console.log('‚úÖ WhatsApp notification sent');
        
        // 8. Prepare success message
        const bookingDate = new Date(currentBooking.date);
        const formattedDate = bookingDate.toLocaleDateString('en-GB', {
            weekday: 'long',
            day: 'numeric',
            month: 'long',
            year: 'numeric'
        });
        
        // 9. Show success message
        const successMessage = `
‚úÖ BOOKING CONFIRMED!

üìã SERVICE DETAILS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Service: ${currentBooking.service.title}
${currentBooking.service.data.hasBedrooms ? `Bedrooms: ${currentBooking.bedrooms}\n` : ''}
Price: ¬£${finalPrice}
Date: ${formattedDate}
Time: ${currentBooking.timeSlot}
Booking Ref: ${bookingRef}

üë§ CUSTOMER DETAILS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Name: ${customerName}
Phone: ${customerPhone}
${customerEmail ? `Email: ${customerEmail}\n` : ''}
Address: ${customerAddress}

üìß CONFIRMATION
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
${emailSent ? 'A confirmation email has been sent to your email address.\n' : customerEmail ? '‚ö†Ô∏è Email confirmation failed. Please save this booking reference.\n' : ''}

üìû NEXT STEPS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
We will call you within 24 hours to confirm all details.

Thank you for choosing GreenGlo Cleaners! üåø
        `;
        
        alert(successMessage);
        
        // 10. Reset form and close modal
        setTimeout(() => {
            closeBookingModal();
            console.log('‚úÖ Booking process completed successfully');
        }, 1000);
        
    } catch (err) {
        console.error('‚ùå CRITICAL ERROR in confirmBooking:', err);
        
        let errorMessage = '‚ùå BOOKING FAILED\n\n';
        
        if (err.message.includes('customer_address')) {
            errorMessage += 'Database configuration error.\n\n';
        } else if (err.message.includes('network') || err.message.includes('fetch')) {
            errorMessage += 'Network connection error.\n\nPlease check your internet connection.';
        } else if (err.message.includes('permission') || err.message.includes('auth') || err.message.includes('policy')) {
            errorMessage += 'Database permission error.\n\n';
        } else if (err.message.includes('duplicate')) {
            errorMessage += 'Time slot already booked.\n\nPlease select another time.';
        } else {
            errorMessage += `Technical error: ${err.message}\n\n`;
        }
        
        errorMessage += '\nüìû PLEASE CALL US DIRECTLY AT:\n07827 784204\n\nWe can take your booking over the phone.';
        
        alert(errorMessage);
        
        console.error('Error context:', {
            currentBooking: currentBooking,
            customerName: customerName,
            customerPhone: customerPhone,
            fullError: err
        });
        
    } finally {
        // Always re-enable the button
        confirmBtn.innerHTML = originalText;
        confirmBtn.disabled = false;
        console.log('üîÑ Confirm button re-enabled');
    }
}

// Helper function to extract price number
function extractPriceNumber(priceString) {
    const match = priceString.match(/¬£(\d+(?:\.\d+)?)/);
    return match ? `¬£${match[1]}` : priceString;
}

// Close booking modal button
document.getElementById('closeBookingModal').addEventListener('click', closeBookingModal);

// ===== Services Data with Enhanced Pricing =====
const servicesData = [
    {
        id: 1,
        title: "Living Room Deep Clean",
        category: "domestic",
        description: "Complete living room cleaning and organization with eco-friendly products.",
        features: ["Complete dust removal", "Furniture cleaning", "Floor sanitization", "Window sills"],
        duration: "2-3 hours",
        hasBedrooms: false,
        basePrice: 75,
        displayPrice: "¬£75",
        image: "livingroom.png"
    },
    {
        id: 2,
        title: "Office Cleaning",
        category: "office",
        description: "Professional office cleaning for businesses and startups.",
        features: ["Workstation sanitization", "Meeting room cleaning", "Kitchenette cleaning", "Floor care"],
        duration: "2-6 hours",
        hasBedrooms: false,
        basePrice: 18,
        displayPrice: "¬£18/hour",
        image: "office.png"
    },
    {
        id: 3,
        title: "Kitchen Deep Cleaning",
        category: "domestic",
        description: "Complete kitchen deep clean including appliances and cabinets.",
        features: ["Oven cleaning included", "Appliance sanitization", "Cabinet cleaning", "Surface degreasing"],
        duration: "2-3 hours",
        hasBedrooms: false,
        basePrice: 85,
        displayPrice: "¬£85",
        image: "kitchen.png"
    },
    {
        id: 4,
        title: "Oven Deep Clean",
        category: "deep",
        description: "Professional oven cleaning for single and double ovens.",
        features: ["Complete interior clean", "Door and glass", "Rack cleaning", "Exterior polish"],
        duration: "1-2 hours",
        hasBedrooms: false,
        basePrice: 40,
        displayPrice: "From ¬£40",
        image: "ovenafter.png"
    },
    {
        id: 5,
        title: "Bathroom Deep Clean",
        category: "deep",
        description: "Complete bathroom sanitization and deep cleaning.",
        features: ["Tile and grout cleaning", "Sanitization", "Fixture polishing", "Mould treatment"],
        duration: "1-2 hours",
        hasBedrooms: false,
        basePrice: 65,
        displayPrice: "¬£65",
        image: "bathroom.png"
    },
    {
        id: 6,
        title: "End of Tenancy Cleaning",
        category: "deep",
        description: "Professional cleaning to ensure full deposit return.",
        features: ["Inventory check ready", "Complete property clean", "Carpet cleaning available", "Guaranteed satisfaction"],
        duration: "4-8 hours",
        hasBedrooms: true,
        basePrice: 220,
        perBedroomPrice: 30,
        displayPrice: "From ¬£220",
        image: "tenancy.png"
    },
    {
        id: 7,
        title: "Carpet Cleaning",
        category: "deep",
        description: "Professional hot water extraction carpet cleaning.",
        features: ["Hot water extraction", "Stain removal", "Quick drying", "Deodorizing"],
        duration: "1-3 hours",
        hasBedrooms: false,
        basePrice: 15,
        displayPrice: "From ¬£15/room",
        image: "carpet.png"
    },
    {
        id: 8,
        title: "Regular Domestic Cleaning",
        category: "domestic",
        description: "Weekly or fortnightly cleaning service.",
        features: ["Dusting & vacuuming", "Kitchen & bathroom", "Surface cleaning", "Floor mopping"],
        duration: "2-4 hours",
        hasBedrooms: false,
        basePrice: 18,
        displayPrice: "¬£18/hour",
        image: "domestic.png"
    },
    {
        id: 9,
        title: "One-Off Deep Clean",
        category: "deep",
        description: "Thorough one-time cleaning for your entire home.",
        features: ["Complete home clean", "Inside cabinets", "Appliance cleaning", "Detailed attention"],
        duration: "4-8 hours",
        hasBedrooms: true,
        basePrice: 150,
        perBedroomPrice: 35,
        displayPrice: "From ¬£150",
        image: "deepclean.png"
    },
    {
        id: 10,
        title: "Window Cleaning",
        category: "special",
        description: "Interior and exterior window cleaning service.",
        features: ["Streak-free finish", "Inside & outside", "Frame cleaning", "Safety equipment"],
        duration: "1-3 hours",
        hasBedrooms: false,
        basePrice: 30,
        displayPrice: "Flat: ¬£30 | House: ¬£45",
        image: "window.png"
    },
    {
        id: 11,
        title: "Upholstery Cleaning",
        category: "deep",
        description: "Sofa, armchair, and car seat deep cleaning.",
        features: ["Stain removal", "Fabric protection", "Deodorizing", "Professional equipment"],
        duration: "1-2 hours",
        hasBedrooms: false,
        basePrice: 55,
        displayPrice: "Sofa 3-seater: ¬£55",
        image: "upholstery.png"
    },
    {
        id: 12,
        title: "After Builders Cleaning",
        category: "deep",
        description: "Post-construction cleanup for renovation projects.",
        features: ["Debris removal", "Dust elimination", "Surface cleaning", "Final touch-up"],
        duration: "4-8 hours",
        hasBedrooms: true,
        basePrice: 200,
        perBedroomPrice: 40,
        displayPrice: "From ¬£200",
        image: "builders.png"
    },
    {
        id: 13,
        title: "Hard Floor Cleaning",
        category: "deep",
        description: "Professional hard floor scrubbing and polishing.",
        features: ["Scrubbing & cleaning", "Polishing", "Sealing available", "Protective coating"],
        duration: "2-4 hours",
        hasBedrooms: false,
        basePrice: 3.5,
        displayPrice: "¬£3.50/m¬≤",
        image: "hardfloor.png"
    },
    {
        id: 14,
        title: "Gutter Cleaning",
        category: "special",
        description: "Gutter clearing and downpipe unblocking service.",
        features: ["Debris removal", "Downpipe clearing", "Flow testing", "Safety first"],
        duration: "1-3 hours",
        hasBedrooms: false,
        basePrice: 75,
        displayPrice: "Terraced house: ¬£75",
        image: "gutter.png"
    },
    {
        id: 15,
        title: "Antiviral Sanitisation",
        category: "special",
        description: "Professional sanitisation against germs and viruses.",
        features: ["99.99% germ kill", "COVID-19 effective", "Safe detergents", "Complete coverage"],
        duration: "1-2 hours",
        hasBedrooms: true,
        basePrice: 120,
        perBedroomPrice: 25,
        displayPrice: "From ¬£120",
        image: "sanitisation.png"
    },
    {
        id: 16,
        title: "BBQ Cleaning",
        category: "special",
        description: "Deep cleaning of BBQs and outdoor cooking equipment.",
        features: ["Grease removal", "Burner cleaning", "Grate scrubbing", "Exterior polish"],
        duration: "1-2 hours",
        hasBedrooms: false,
        basePrice: 45,
        displayPrice: "Small BBQ: ¬£45",
        image: "bbq.png"
    },
    {
        id: 17,
        title: "Commercial Cleaning",
        category: "office",
        description: "Regular commercial cleaning for businesses.",
        features: ["Daily/weekly service", "Floor maintenance", "Restroom cleaning", "Waste removal"],
        duration: "2-8 hours",
        hasBedrooms: false,
        basePrice: 25,
        displayPrice: "¬£25/hour",
        image: "commercial.png"
    },
    {
        id: 18,
        title: "Move In/Move Out Cleaning",
        category: "deep",
        description: "Complete cleaning for moving properties.",
        features: ["Empty property clean", "Deep sanitization", "Ready for new tenants", "Quick turnaround"],
        duration: "3-6 hours",
        hasBedrooms: true,
        basePrice: 180,
        perBedroomPrice: 40,
        displayPrice: "From ¬£180",
        image: "moveclean.png"
    },
    {
        id: 19,
        title: "Patio & Decking Cleaning",
        category: "special",
        description: "Pressure washing for patios and decking areas.",
        features: ["Pressure washing", "Moss removal", "Stain treatment", "Restoration"],
        duration: "2-4 hours",
        hasBedrooms: false,
        basePrice: 70,
        displayPrice: "From ¬£70",
        image: "patio.png"
    },
    {
        id: 20,
        title: "Spring Cleaning",
        category: "deep",
        description: "Seasonal deep cleaning service.",
        features: ["Complete home refresh", "Behind furniture", "Wardrobe organization", "Decluttering help"],
        duration: "4-8 hours",
        hasBedrooms: true,
        basePrice: 175,
        perBedroomPrice: 35,
        displayPrice: "From ¬£175",
        image: "spring.png"
    },
    {
        id: 21,
        title: "Carpet Stain Removal",
        category: "deep",
        description: "Specialized treatment for stubborn carpet stains.",
        features: ["Professional treatment", "Odor removal", "Color restoration", "Guaranteed results"],
        duration: "1-2 hours",
        hasBedrooms: false,
        basePrice: 35,
        displayPrice: "From ¬£35/stain",
        image: "stain.png"
    },
    {
        id: 22,
        title: "Emergency Cleaning",
        category: "special",
        description: "24/7 emergency cleaning services.",
        features: ["24/7 availability", "Fast response", "Flood cleanup", "Accident cleanup"],
        duration: "2-6 hours",
        hasBedrooms: false,
        basePrice: 35,
        displayPrice: "¬£35/hour",
        image: "emergency.png"
    }
];

// ===== Render Services with Enhanced Price Display =====
const servicesGrid = document.getElementById('servicesGrid');

function renderServices(category = 'all') {
    servicesGrid.innerHTML = '';

    const filteredServices = category === 'all'
        ? servicesData
        : servicesData.filter(service => service.category === category);

    filteredServices.forEach(service => {
        const serviceCard = document.createElement('div');
        serviceCard.className = 'service-card';
        serviceCard.setAttribute('data-category', service.category);

        // Generate price tiers for bedroom-based services
        let priceContent = '';
        if (service.hasBedrooms) {
            const tiers = [
                { bedrooms: 1, price: service.basePrice, badge: 'gold' },
                { bedrooms: 2, price: service.basePrice + service.perBedroomPrice, badge: 'silver' },
                { bedrooms: 3, price: service.basePrice + (service.perBedroomPrice * 2), badge: 'bronze' }
            ];
            
            priceContent = `
                <div class="service-price-container">
                    <div class="price-tag-main">¬£${service.basePrice}</div>
                    <div class="price-tier-container">
                        ${tiers.map(tier => `
                            <div class="price-tier">
                                <div class="tier-badge ${tier.badge}">${tier.bedrooms} BED</div>
                                <div class="tier-bedrooms">${tier.bedrooms} Bedroom${tier.bedrooms > 1 ? 's' : ''}</div>
                                <div class="tier-price">¬£${tier.price}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        } else {
            priceContent = `
                <div class="service-price-container" style="text-align: center;">
                    <div class="price-tag-main">${service.displayPrice}</div>
                </div>
            `;
        }

        serviceCard.innerHTML = `
            <div class="service-image" style="background-image: url('${service.image}'); background-color: var(--light-green);">
                <div class="service-overlay">
                    <h3>${service.title}</h3>
                </div>
            </div>
            <div class="service-content">
                ${priceContent}
                
                <div style="text-align: center; margin: 1rem 0;">
                    <span class="service-duration-badge">
                        <i class="far fa-clock"></i> ${service.duration}
                    </span>
                </div>
                
                <p class="service-description">${service.description}</p>
                <ul class="service-features">
                    ${service.features.map(feature => `
                        <li><i class="fas fa-check"></i>${feature}</li>
                    `).join('')}
                </ul>
                <div class="service-meta">
                    <div class="service-cta">
                        <button class="btn book-service-btn" 
                                data-service-id="${service.id}" 
                                data-service-title="${service.title}"
                                style="padding: 1rem 2rem; font-size: 1.125rem; background: var(--gradient-primary);">
                            <i class="fas fa-calendar-check"></i>
                            Book Now
                        </button>
                    </div>
                </div>
            </div>
        `;

        servicesGrid.appendChild(serviceCard);
    });

    // Add event listeners to booking buttons
    document.querySelectorAll('.book-service-btn').forEach(button => {
        button.addEventListener('click', function() {
            const serviceId = this.getAttribute('data-service-id');
            const serviceTitle = this.getAttribute('data-service-title');
            const serviceData = servicesData.find(s => s.id == serviceId);
            openBookingModal(serviceTitle, serviceId, serviceData);
        });
    });

    // Add loading animation
    const serviceCards = document.querySelectorAll('.service-card');
    serviceCards.forEach((el, index) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
        
        setTimeout(() => {
            el.style.opacity = '1';
            el.style.transform = 'translateY(0)';
        }, 100 + (index * 100));
    });
    
    console.log(`‚úÖ Rendered ${filteredServices.length} services`);
}

// ===== Category Filtering =====
const categoryButtons = document.querySelectorAll('.category-btn');

categoryButtons.forEach(button => {
    button.addEventListener('click', () => {
        // Remove active class from all buttons
        categoryButtons.forEach(btn => btn.classList.remove('active'));
        // Add active class to clicked button
        button.classList.add('active');

        const category = button.getAttribute('data-category');
        console.log(`Filtering by category: ${category}`);
        renderServices(category);
    });
});

// ===== Smooth Scrolling =====
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        if (this.getAttribute('href') === '#') return;

        e.preventDefault();
        const targetId = this.getAttribute('href');
        const targetElement = document.querySelector(targetId);

        if (targetElement) {
            window.scrollTo({
                top: targetElement.offsetTop - 80,
                behavior: 'smooth'
            });
        }
    });
});

// ===== Initialize Page =====
document.addEventListener('DOMContentLoaded', function() {
    console.log('üìÑ DOM fully loaded, initializing services...');
    
    // Initial render
    renderServices();
    
    // Add database test button for debugging
    const debugBtn = document.createElement('button');
    debugBtn.innerHTML = 'üîß Test System';
    debugBtn.style.cssText = `
        position: fixed;
        bottom: 100px;
        right: 30px;
        background: var(--dark-green);
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 50px;
        cursor: pointer;
        z-index: 9998;
        font-size: 12px;
        opacity: 0.7;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    `;
    debugBtn.onclick = async () => {
        console.log('üîß Running system test...');
        
        // Test 1: Database connection
        const dbResult = await checkDatabaseSchema();
        
        // Test 2: Email connection
        let emailResult = { success: false };
        try {
            const testEmail = 'test@example.com';
            const testData = {
                service: 'Test Service',
                date: '2024-01-01',
                timeSlot: '10:00-12:00',
                duration: '2 hours',
                price: '¬£99',
                customerName: 'Test User',
                customerPhone: '07123456789',
                customerEmail: testEmail,
                customerAddress: 'Test Address',
                bookingId: 'TEST123'
            };
            
            // Just test the API call without actually sending
            const response = await fetch('https://api.resend.com/emails', {
                method: 'HEAD',
                headers: {
                    'Authorization': `Bearer ${RESEND_API_KEY}`,
                    'Content-Type': 'application/json'
                }
            });
            
            emailResult.success = response.status !== 401;
            
        } catch (e) {
            emailResult.error = e.message;
        }
        
        alert(`System Test Results:\n\n‚úÖ Database: ${dbResult ? 'Connected' : 'Failed'}\n‚úÖ Email API: ${emailResult.success ? 'Connected' : 'Failed'}\n\nCheck console for details.`);
    };
    document.body.appendChild(debugBtn);
    
    console.log('üéâ Services page fully initialized');
});

// ===== Emergency Contact Display =====
function showEmergencyContact() {
    const emergencyDiv = document.createElement('div');
    emergencyDiv.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        z-index: 10001;
        text-align: center;
        max-width: 400px;
        animation: fadeIn 0.3s ease;
    `;
    
    emergencyDiv.innerHTML = `
        <div style="color: var(--primary-green); font-size: 48px; margin-bottom: 20px;">
            <i class="fas fa-phone-alt"></i>
        </div>
        <h3 style="color: var(--dark-green); margin-bottom: 15px;">Booking System Unavailable</h3>
        <p style="color: var(--dark-gray); margin-bottom: 25px;">
            There seems to be a technical issue with our online booking system.
        </p>
        <div style="background: var(--light-green); padding: 20px; border-radius: 12px; margin-bottom: 25px;">
            <div style="font-size: 28px; font-weight: 700; color: var(--dark-green); margin-bottom: 10px;">
                07827 784204
            </div>
            <div style="color: var(--medium-gray); font-size: 14px;">
                Call us directly to book your service
            </div>
        </div>
        <button onclick="this.parentElement.remove()" style="background: var(--primary-green); color: white; border: none; padding: 12px 30px; border-radius: 50px; cursor: pointer; font-weight: 600;">
            Close
        </button>
    `;
    
    document.body.appendChild(emergencyDiv);
}

// Export functions for debugging
window.testBooking = async function() {
    console.log('üß™ Test booking function called');
    const testData = {
        service_title: 'Test Service',
        service_id: 1,
        customer_name: 'Test User',
        customer_phone: '07123456789',
        customer_email: 'test@example.com',
        customer_address: '123 Test Street, London',
        booking_date: '2024-12-31',
        time_slot: '10:00-12:00',
        duration: '2 hours',
        price: '¬£99',
        notes: 'Test booking',
        status: 'test',
        booking_reference: 'TEST' + Date.now()
    };
    
    const result = await supabaseClient.from('bookings').insert([testData]).select();
    console.log('Test result:', result);
    return result;
};

// Final initialization check
window.addEventListener('load', () => {
    console.log('üöÄ Page fully loaded');
    console.log('Supabase client:', supabaseClient ? '‚úÖ Initialized' : '‚ùå Not initialized');
    console.log('Resend API:', '‚úÖ Ready for email confirmation');
    console.log('Booking system:', '‚úÖ Fully operational with bedroom selection');
});
    </script>
</body>
</html>
